---
const { items=[], multiple=true, value=[], name='kw' } = Astro.props;
---
<div class="chip-wrap" data-name={name}>
  {items.map((txt) => (
    <button type="button" class={"chip" + (value.includes(txt)?' active':'')} data-v={txt}>{txt}</button>
  ))}
</div>
<style>
.chip-wrap{display:flex;flex-wrap:wrap;gap:8px}
.chip{border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px;background:#f3f4f6;color:#111827;font-size:14px;cursor:pointer}
.chip.active{background:#0f2d5e;color:#fff;border-color:#0f2d5e}
</style>

<script is:inline>
(() => {
  const root = document.currentScript.previousElementSibling;
  if (!root) return;
  root.addEventListener('click', (e) => {
    const t = e.target.closest('button.chip');
    if (!t) return;
    t.classList.toggle('active');

    const active = [...root.querySelectorAll('.chip.active')].map(b => b.dataset.v);
    root.dispatchEvent(new CustomEvent('chipchange', {
      detail: { name: root.dataset.name, value: active },
      bubbles: true,
      composed: true
    }));
  });
})();
</script>

